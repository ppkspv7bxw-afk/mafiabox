<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>GameHub4u</title>

<style>
:root{
  --bg:#0b1020; --text:#eef1ff; --muted:#a7b0d6;
  --border:rgba(255,255,255,.12);
  --red:#ff2e55; --green:#2ee59d;
  --btn1:#ff3b6a; --btn2:#ff1f4f;
  --radius:18px;
}
*{box-sizing:border-box}
body{
  margin:0;font-family:system-ui;
  background:radial-gradient(1100px 760px at 70% 0%,#1a2350 0%,var(--bg) 55%);
  color:var(--text)
}
.wrap{max-width:560px;margin:auto;padding:22px}
.card{
  background:rgba(255,255,255,.05);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:18px; position:relative
}
.status{
  position:absolute;top:14px;left:14px;
  width:14px;height:14px;border-radius:50%;
  background:var(--red)
}
.status.ok{background:var(--green)}

.brand{text-align:center;margin-bottom:12px}
.brand img{width:220px}

.btn{
  width:100%;margin-top:12px;
  border:0;border-radius:14px;
  padding:14px;font-weight:900;
  color:#fff;cursor:pointer;
  background:linear-gradient(135deg,var(--btn1),var(--btn2))
}
.btn.secondary{
  background:rgba(255,255,255,.1)
}

.hidden{display:none}

.roomCode{
  font-size:54px;font-weight:900;
  letter-spacing:8px;text-align:center;
  padding:12px;border-radius:14px;
  background:rgba(0,0,0,.3)
}

.grid{margin-top:12px;display:grid;grid-template-columns:1fr 1fr;gap:10px}
.player{
  padding:10px;border-radius:12px;
  background:rgba(255,255,255,.06);
  display:flex;justify-content:space-between;align-items:center
}
.player .ready{color:var(--green)}
.player .notready{color:var(--red)}
</style>
</head>

<body>
<div class="wrap">
<div class="card">
<span id="status" class="status"></span>

<div class="brand">
  <img src="/brand.png"/>
</div>

<!-- JOIN -->
<div id="joinView">
  <input id="room" placeholder="ROOM CODE"/>
  <input id="name" placeholder="اسمك"/>
  <button id="join" class="btn">دخول</button>
</div>

<!-- LOBBY -->
<div id="lobbyView" class="hidden">
  <div class="roomCode" id="roomBig"></div>

  <div class="grid" id="players"></div>

  <button id="ready" class="btn">Ready</button>
  <button id="leave" class="btn secondary">Leave</button>
</div>

</div>
</div>

<script src="https://jackbox-server-pwtr.onrender.com/socket.io/socket.io.js"></script>
<script>
const socket = io("https://jackbox-server-pwtr.onrender.com");
const status = document.getElementById("status");

const joinView = document.getElementById("joinView");
const lobbyView = document.getElementById("lobbyView");

const roomInput = document.getElementById("room");
const nameInput = document.getElementById("name");
const joinBtn = document.getElementById("join");

const roomBig = document.getElementById("roomBig");
const playersEl = document.getElementById("players");
const readyBtn = document.getElementById("ready");
const leaveBtn = document.getElementById("leave");

let myName="", myRoom="", isReady=false;

socket.on("connect",()=>status.classList.add("ok"));
socket.on("disconnect",()=>status.classList.remove("ok"));

joinBtn.onclick=()=>{
  myRoom=roomInput.value.toUpperCase();
  myName=nameInput.value.trim();
  socket.emit("player:join",{roomCode:myRoom,name:myName});
};

readyBtn.onclick=()=>{
  isReady=!isReady;
  socket.emit("player:ready",{roomCode:myRoom,ready:isReady});
  readyBtn.textContent=isReady?"Unready":"Ready";
};

leaveBtn.onclick=()=>{
  socket.emit("player:leave",{roomCode:myRoom});
  lobbyView.classList.add("hidden");
  joinView.classList.remove("hidden");
};

socket.on("room:state",({roomCode,players})=>{
  joinView.classList.add("hidden");
  lobbyView.classList.remove("hidden");
  roomBig.textContent=roomCode;

  playersEl.innerHTML="";
  players.forEach(p=>{
    const d=document.createElement("div");
    d.className="player";
    d.innerHTML=`
      <span>${p.name}</span>
      <span class="${p.ready?"ready":"notready"}">
        ${p.ready?"READY":"WAIT"}
      </span>`;
    playersEl.appendChild(d);
  });
});
</script>
</body>
</html>
